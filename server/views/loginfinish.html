<html>
<head>
<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.5/angular.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ngStorage/0.3.11/ngStorage.min.js"></script>

<script>
angular.module('googleloginApp',[])
.controller('googleloginCtrl',function($scope,$window,$location,$localStorage) {
	console.log("isopen:"+$window.isOpen);
	$window.isOpen=false;
	$window.userId={{userId}};
	$window.userTok='{{token}}';
	var the_result={
		"token":"{{token}}",
		"userId":{{userId}}
	};

	window.addEventListener('message',function(event) {
		//if(event.origin !== 'http://davidwalsh.name') return;
		console.log('message received:  ' + event.data,event);
		event.source.postMessage(the_result,event.origin);
		
	},false);
	
	$scope.btnClick=function(){
	
	};
});
</script>
</head>
<body ng-app="googleloginApp" ng-controller="googleloginCtrl" id="mybody">
<h1>Finish</h1>
<pre>user:{{user}}
email:{{email}}

</pre>

<button ng-click="btnClick();">Close</button>

<script>
$( document ).ready(function() {
		console.log( "ready!" );
		window.localStorage.setItem('userId',{{userId}});
		window.localStorage.setItem('userTok','{{token}}');
		window.isOpen=false;
		window.userId={{userId}};
		window.userTok='{{token}}';
});
</script>
</body>
</html>